<Project>

  <PropertyGroup>
    <SourceRoot>$(MSBuildThisFileDirectory)</SourceRoot>
    <EngRoot>$(MSBuildThisFileDirectory)..\eng\</EngRoot>

    <AssemblyOriginatorKeyFile>$(EngRoot)Abc.snk</AssemblyOriginatorKeyFile>
  </PropertyGroup>

  <PropertyGroup>
    <!--
      The first listed framework is the one used by the VS editor.
      Full NRT-analysis requires .NET Core 3.0 or above, .NET Standard does
      not include the nullable annotations (version 2.1 defines the nullable
      attributes but don't use them if I understand things correctly).
      We use the version 3.1 instead of 3.0 because the former is LTS and the
      latter is already EOL.
      For libraries, use
        <TargetFrameworks>$(MaxApiPlatform);netstandard2.0</TargetFrameworks>
      otherwise, use
        <TargetFramework>$(MaxApiPlatform)</TargetFramework>
      If/when we create an API depending on a new .NET standard, MaxApiPlatform
      should be the last available platform supporting it We can also update
      MaxApiPlatform just to benefit from the last improvements it could bring.
    -->
    <MaxApiPlatform>netcoreapp3.1</MaxApiPlatform>
  </PropertyGroup>

  <PropertyGroup>
    <!-- Local options -->
    <DisplaySettings>false</DisplaySettings>
    <PatchEquality>false</PatchEquality>
    <HideInternals>false</HideInternals>
    <!-- Meta-option -->
    <Retail>false</Retail>
  </PropertyGroup>

  <PropertyGroup Condition=" $(Retail) == 'true' ">
    <!--
      *** BE VERY, VERY CAREFUL, BEFORE CHANGING THIS ***

      Weird bug in MSBuild; see https://github.com/Microsoft/msbuild/issues/2754
      First, it must stay here, it can't be in Directory.Build.targets
      Second, What we really want is sketched in Directory.Build.targets but
      even if use what's there here, it does NOT work.
    -->
    <DebugType>embedded</DebugType>
    <DebugType Condition=" $(TargetFramework.StartsWith('net4')) ">full</DebugType>
    <AllowedOutputExtensionsInPackageBuildOutputFolder>$(AllowedOutputExtensionsInPackageBuildOutputFolder);.pdb</AllowedOutputExtensionsInPackageBuildOutputFolder>
  </PropertyGroup>

  <PropertyGroup>
    <!-- Package metadata & assembly info -->

    <Authors>Chtoucas</Authors>
    <Company>Narvalo.Org</Company>
    <Product>Abécédaire Library</Product>
    <Copyright>Copyright (c) 2019 Narvalo.Org</Copyright>

    <PackageProjectUrl>https://github.com/chtoucas/Abc.Maybe/</PackageProjectUrl>
    <PackageLicenseExpression>BSD-3-Clause</PackageLicenseExpression>
    <PackageReleaseNotes>See CHANGELOG in project root.</PackageReleaseNotes>

    <RepositoryType>git</RepositoryType>
    <RepositoryUrl>https://github.com/chtoucas/Abc.Maybe/</RepositoryUrl>
  </PropertyGroup>

  <PropertyGroup>
    <RootNamespace>Abc</RootNamespace>

    <LangVersion>latest</LangVersion>
    <CheckForOverflowUnderflow>true</CheckForOverflowUnderflow>
    <Nullable>enable</Nullable>

    <TreatWarningsAsErrors>true</TreatWarningsAsErrors>

    <!-- CONTRACTS_FULL is necessary to enable the attribute Pure -->
    <DefineConstants>$(DefineConstants);TRACE;CONTRACTS_FULL</DefineConstants>

    <!--
      Fake version only used during development. For Retail builds of a package,
      the version is set within eng\Retail.targets which is loaded later on.
    -->
    <VersionPrefix>1.0.0</VersionPrefix>
    <VersionSuffix>DUMMY</VersionSuffix>
  </PropertyGroup>

  <PropertyGroup Condition=" $(Configuration) == 'Debug' ">
    <DefineConstants>$(DefineConstants);DEBUG</DefineConstants>

    <TreatWarningsAsErrors>false</TreatWarningsAsErrors>
    <TreatSpecificWarningsAsErrors />

    <!--
      RS0016  Symbol XXX is not part of the declared API
      RS0017  Symbol XXX is part of the declared API, but is either not public
              or could not be found
    -->
    <NoWarn>$(NoWarn);RS0016;RS0017</NoWarn>
  </PropertyGroup>

</Project>
